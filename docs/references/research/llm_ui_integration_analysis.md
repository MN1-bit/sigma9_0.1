# LLM UI 통합 전략 분석: 분산형 컨텍스트 vs 중앙 집중형 오라클

## 1. 개요
Sigma9 트레이딩 시스템의 Phase 4 지능화(Intelligence) 구현과 관련하여, LLM 기능을 GUI에 통합하는 두 가지 접근 방식을 분석합니다.
1.  **분산형 컨텍스트 (Distributed Context)**: 기존 계획. 툴팁, 팝업 등 각 요소 근처에 정보 분산.
2.  **중앙 집중형 오라클 (Dedicated Oracle Panel)**: 사용자 제안. 우측 패널 등을 할당하여 채팅/리포트 형식으로 소통.

이 문서는 사용자가 제시한 4가지 핵심 유스케이스(선정 사유, 펀더멘탈, 매매 반성, 일반 질의)를 중심으로 두 방식을 비교 평가합니다.

## 2. 접근 방식 비교

### 옵션 A: 분산형 컨텍스트 (기존 설계)
정보가 필요한 "그 위치"에 LLM 통찰을 툴팁이나 작은 팝업으로 녹여내는 방식입니다.

*   **UI 형태**: 차트 위 툴팁, Watchlist 우클릭 메뉴, 로그 창의 한 줄 메시지.
*   **장점**:
    *   **공간 효율성**: 별도의 패널 공간을 차지하지 않음.
    *   **즉시성**: 마우스 오버만으로 빠른 확인 가능.
*   **단점**:
    *   **깊이의 한계**: "매매 반성"이나 "기업 펀더멘탈 분석"처럼 긴 텍스트를 담기에 부적합.
    *   **상호작용 불가**: 사용자가 추가 질문(Follow-up question)을 하기 어려움.
    *   **휘발성**: 툴팁은 마우스를 치우면 사라지므로 정보를 곱씹어 보기 힘듦.

### 옵션 B: 중앙 집중형 오라클 (사용자 제안)
독립된 패널(예: 우측)을 할당하여 LLM과 대화하거나 긴 리포트를 출력하는 방식입니다.

*   **UI 형태**: 채팅 인터페이스 또는 리포트 뷰어 (Right Panel).
*   **장점**:
    *   **심층 분석**: 긴 호흡의 글(반성문, 재무제표 분석)을 읽기 편함.
    *   **기록 보존**: 대화 내역이나 리포트가 스크롤되어 남아있음.
    *   **유연성**: "A 종목은 어때?" 하다가 "그럼 B는?" 하고 자연스럽게 전환 가능.
*   **단점**:
    *   **공간 점유**: 항상 화면의 일부(20~25%)를 차지해야 함. (기존 Positions 패널과 공간 경합)
    *   **시선 분산**: 차트를 보다가 오라클 패널로 시선을 크게 옮겨야 함.

## 3. 사용자 요구사항(Use Cases) 기반 평가

| 유스케이스 | 옵션 A (분산형) 적합도 | 옵션 B (중앙 집중형) 적합도 | 분석 |
| :--- | :---: | :---: | :--- |
| **1. 선정 사유 & 재료** | 🟡 보통 | 🟢 우수 | "이유"는 짧게 요약 가능(A)하나, "재료/뉴스" 등 상세 문맥은 긴 글(B)이 유리함. |
| **2. 펀더멘탈 분석** | 🔴 부적합 | 🟢 우수 | 재무제표, 섹터 현황 등은 툴팁(A)에 담을 수 없음. 전용 패널(B) 필수. |
| **3. 매매 반성 (Reflection)** | 🔴 부적합 | 🟢 최적 | "오늘의 매매 복기"는 하나의 완결된 에세이 형태이므로 오라클 패널(B)이 최적. |
| **4. 지능화 관련 질문** | 🔴 불가 | 🟢 최적 | 자유 질문/답변은 채팅 인터페이스(B)가 있어야만 가능. |

> **판단**: 사용자가 원하는 기능들은 단순한 "데이터 확인"이 아니라 **"심층적 인사이트 도출 및 질의응답"**에 해당하므로, 기존의 분산형 설계보다는 **중앙 집중형 오라클** 방식이 압도적으로 유리합니다.

## 4. 통합 솔루션 제안: "Hybrid Tabbed Panel"

우측 패널(Right Panel)은 현재 **Positions & P&L(포지션 및 손익)** 정보를 위해 사용 중입니다. 이 공간을 오라클에게 완전히 내어주면, 실시간 손익 확인이 불편해지는 문제가 발생합니다.

따라서 두 마리 토끼를 잡는 **탭(Tab) 구조**를 제안합니다.

### 우측 패널 구조 변경 (Right Panel)
우측 패널 상단에 탭을 배치하여 모드를 전환합니다.

1.  **Tab 1: Trading (Default)**
    *   기존 기능 유지 (현재가, 보유 포지션, 미실현 손익, 강제 청산 버튼).
    *   빠른 대응이 필요한 긴박한 매매 상황에서 사용.

2.  **Tab 2: Oracle (Intelligence)**
    *   **Chat Interface**: 하단 입력창, 상단 대화 내역.
    *   **Preset Buttons (프롬프트 단축키)**:
        *   `[Why Selected?]`: 현재 선택된 종목의 선정 이유 및 재료 브리핑 요청.
        *   `[Fundamental]`: 현재 종목의 펀더멘탈/재무/섹터 분석 요청.
        *   `[Daily Reflection]`: 장 마감 후 오늘의 매매 전체 복기 및 반성 리포트 생성.
    *   **Auto-Push**:
        *   매수 진입 시: 자동으로 "이 종목을 진입한 AI의 판단"을 짧게 출력.
        *   매도 청산 시: "청산 사유 및 손익 분석"을 출력.

### 워크플로우 예시
1.  **탐색 단계**: Watchlist에서 종목 클릭 → 우측 `Oracle` 탭에서 `[Why Selected?]` 클릭하여 상세 분석 확인.
2.  **진입 결정**: 확신이 서면 우측 `Trading` 탭으로 전환(또는 단축키)하여 진입 대기.
3.  **트레이딩 중**: `Trading` 탭에서 P&L 감시 및 대응.
4.  **장 마감/휴식**: 다시 `Oracle` 탭으로 가서 `[Daily Reflection]`을 눌러 매매 복기.

## 5. 결론 및 권고

사용자가 정의한 **"스스로 반성하고 설명하는 AI"**를 구현하기 위해서는 **독립된 오라클 패널(Option B)**이 올바른 방향입니다.

다만, 트레이딩의 편의성을 위해 **우측 패널을 탭 구조로 개편**하여, [Trading] 모드와 [Oracle] 모드를 상황에 맞춰 오갈 수 있도록 구현하는 것이 최적의 설계입니다.

**수정 제안 (Phase 4 Plan 업데이트 시 반영):**
*   **UI 변경**: 우측 패널을 `QTabWidget` 또는 유사한 커스텀 탭으로 변경.
*   **기능 추가**: `OracleWidget` 구현 (채팅 UI + Markdown 렌더링 지원).
*   **연동**: Watchlist 선택 변경 시 Oracle 패널에도 '현재 종목' 컨텍스트 전달.
