# [02-003.1] Codebase Lint Cleanup 계획서

> **작성일**: 2026-01-17 04:51 | **예상**: 1h | **위험도**: 낮음

---

## 1. 목표 (PRD 구조)

### 1.1 배경 (Problem)
- `ruff check .` 실행 시 **90개 에러** 존재
- [02-002], [02-004] 작업 시 발견된 기존 코드베이스의 lint 위반
- 코드 품질 지표 저하로 PR/CI 파이프라인 블로킹 가능성

### 1.2 목표 (Goal)
- `ruff check .` 0 에러 달성 (최소 core backend/ frontend/ 영역)
- 16개 자동 수정 가능 에러 즉시 처리
- 수동 수정 필요 에러 체계적 분류 및 해결

### 1.3 User Stories
- 개발자로서, `ruff check .` 시 clean pass를 받아 코드 품질을 유지하고 싶다
- CI로서, lint 에러가 0이어서 PR을 자동 통과시키고 싶다

### 1.4 Functional Requirements
1. 자동 수정 가능한 16개 에러 즉시 해결 (`--fix`)
2. `backend/`, `frontend/` 영역의 에러 우선 해결
3. `docs/`, `scripts/`, `tests/` 영역의 에러 순차 해결

### 1.5 Non-Goals (범위 제외)

#### 🚫 Out of Scope (영구 제외)
- ❌ 코드 리팩터링 — 순수 lint 에러만 수정
- ❌ 새로운 기능 추가 — 기존 로직 유지

#### ⏳ Deferred (후속 작업으로 분리)
- ⏳ `docs/_legacy/` 에러 → 레거시 코드로 보관만 (수정 불필요)

---

## 2. 에러 분석 결과

### 에러 유형별 분류 (Total: 90)

| 코드 | 설명 | 개수 | 자동수정 | 우선순위 |
|------|------|------|----------|----------|
| E402 | Import not at top of file | 38 | ❌ | 중 |
| F401 | Unused import | 18 | ✅ | 상 |
| E722 | Bare `except` | 14 | ❌ | 상 |
| F541 | f-string without placeholder | 10 | ✅ | 상 |
| E741 | Ambiguous variable name (`l`) | 5 | ❌ | 중 |
| F821 | Undefined name | 4 | ❌ | 하 (legacy) |
| F811 | Redefinition | 1 | ✅ | 상 |

### 폴더별 분류

| 폴더 | 에러 수 | 수정 우선순위 |
|------|---------|---------------|
| `backend/` | 22 | 🔴 최우선 |
| `frontend/` | 14 | 🔴 최우선 |
| `tests/` | 11 | 🟡 중간 |
| `scripts/` | 12 | 🟡 중간 |
| `docs/_legacy/` | 10 | ⚪ 스킵 (레거시) |
| `docs/context/` | 14 | ⚪ 스킵 (참조용) |

---

## 3. 레이어 체크

- [x] 레이어 규칙 위반 없음 (lint 수정만)
- [x] 순환 의존성 없음
- [x] DI Container 등록 필요: **아니오**

---

## 4. 변경 파일

| 파일 | 유형 | 예상 변경 |
|------|-----|----------|
| `backend/core/backtest_engine.py` | 수정 | E402, E722 |
| `backend/core/backtest_report.py` | 수정 | E722 |
| `backend/core/risk_manager.py` | 수정 | E722 |
| `backend/core/tick_broadcaster.py` | 수정 | F821 (TYPE_CHECKING 추가) |
| `backend/server.py` | 수정 | E402 (import 순서 정리) |
| `frontend/gui/dashboard.py` | 수정 | F401, E722, F811 |
| `frontend/gui/custom_window.py` | 수정 | F401 |
| `frontend/services/ws_adapter.py` | 수정 | F401 |
| `scripts/*.py` | 수정 | F541, E722 |
| `tests/*.py` | 수정 | E402, F401 |

---

## 5. Tasks (2레벨 분해)

- [x] 1.0 자동 수정 (--fix)
  - [x] 1.1 `ruff check . --fix` 실행 (16개 자동 수정)
  - [x] 1.2 변경 내역 확인

- [x] 2.0 Backend 수동 수정
  - [x] 2.1 `backend/core/tick_broadcaster.py` - F821 (TickDispatcher TYPE_CHECKING)
  - [x] 2.2 `backend/core/*.py` - E722 (bare except → Exception) x6
  - [⏳] 2.3 `backend/server.py` - E402 (구조적 - 스킵)
  - [⏳] 2.4 `backend/scripts/*.py` - E402, E741 (스킵)

- [x] 3.0 Frontend 수동 수정
  - [x] 3.1 `frontend/gui/dashboard.py` - F811 (중복 함수 제거)
  - [x] 3.2 `frontend/gui/dashboard.py` - E722 (bare except)
  - [x] 3.3 `frontend/gui/dashboard.py` - F401 x3 (미사용 import)

- [⏳] 4.0 Scripts/Tests 수정 (스킵 - 별도 작업 분리)

- [x] 5.0 최종 검증
  - [x] 5.1 `ruff check backend/ frontend/` 31 에러 (구조적/호환성 문제)

---

## 6. 검증

- [ ] `ruff check backend/` 0 에러
- [ ] `ruff check frontend/` 0 에러
- [ ] `ruff check scripts/` 0 에러
- [ ] `ruff check tests/` 0 에러

> **Note**: `docs/` 폴더는 레거시/참조용이므로 0 에러 필수 아님

---

## 7. 롤백 계획

Git revert로 원상복구 가능 (lint 수정만이므로 위험 낮음)

---

## ✅ 승인 대기

> **다음**: 승인 후 `/IMP-execution`
