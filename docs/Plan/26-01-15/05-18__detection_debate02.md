# 급등 전 스캐닝 전략: 방법론 토론 (v2)

> **문서 번호**: 001-01 부속 토론 v2  
> **작성일**: 2026-01-15  
> **대상 문서**: [_detection.md](./_detection.md)  
> **핵심 질문**: Daygainer 특징 분석에 ML이 유리한가, LLM이 유리한가?

---

## 전제: 파이프라인 구조

분석 대상 파이프라인은 다음과 같이 고정됨:

```
┌─────────────────────────────────────────────────────────────────────┐
│  1. 데이터 수집                                                      │
│     Raw Data + 모든 보조지표 (RVOL, ATR, MA, RSI, 거래량 프로파일 등)  │
│     → 역대 Daygainer 목록 수집                                       │
└───────────────────────────────┬─────────────────────────────────────┘
                                ▼
┌─────────────────────────────────────────────────────────────────────┐
│  2. Daygainer 정보 정리                                              │
│     각 Daygainer의 D-1, D-2 시점 지표들을 DB에 구조화                 │
└───────────────────────────────┬─────────────────────────────────────┘
                                ▼
┌─────────────────────────────────────────────────────────────────────┐
│  3. 대조군 형성 (LLM + Massive MCP)                                  │
│     - LLM이 섹터, 시총, 유동성 유사한 비급등 종목 매칭                 │
│     - Massive API로 과거 데이터 조회                                 │
└───────────────────────────────┬─────────────────────────────────────┘
                                ▼
┌─────────────────────────────────────────────────────────────────────┐
│  4. 특징 분석 ← 🎯 이 단계가 토론 대상                               │
│     "Daygainer들만의 공통 특징이 있는가?"                            │
│     → ML로 할 것인가? LLM으로 할 것인가?                             │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 등장인물

| 역할 | 관점 |
|------|------|
| **백엔드 개발자** | 시스템 구현 가능성, 운영 비용 |
| **ML 엔지니어** | 모델 설계, 통계적 유효성 |
| **퀀트** | 알파 발굴, 과적합 방지 |
| **단타 트레이더** | 실전 패턴, 경험적 직관 |
| **금융공학 리서처** | 기관 관점, 리스크/거버넌스 |

---

## 1라운드: 문제 정의

### 🔧 백엔드 개발자

> 4단계를 정확히 정의해주세요. "특징 분석"이란 구체적으로 뭘 원하는 건가요?

---

### 📊 퀀트

두 가지 질문으로 나뉩니다:

**질문 A (탐색적)**: "Daygainer들에게 공통된 패턴이 무엇인가?"
- 열린 질문, 사전 가설 없음
- 수십 개 지표 중 어떤 게 의미 있는지 발견

**질문 B (검증적)**: "특정 지표 조합이 급등을 예측하는가?"
- 닫힌 질문, 가설 검증
- 통계적 유의성 확인

**핵심**: 우리가 원하는 건 A인가 B인가?

---

### 💹 단타 트레이더

둘 다 아닌가요? 

저는 이렇게 생각해요:
1. 먼저 A로 "어떤 패턴이 있는지" 탐색
2. 그걸 B로 "그 패턴이 진짜인지" 검증

순서가 중요합니다. B부터 하면 뭘 검증해야 할지도 모르잖아요.

---

### 🤖 ML 엔지니어

맞습니다. 그래서 질문을 재정의하면:

| 단계 | 작업 | 적합 도구? |
|------|------|-----------|
| 4a. 탐색 (EDA) | 무엇이 다른가? | ???  |
| 4b. 모델링 | 예측 모델 구축 | ??? |
| 4c. 해석 | 왜 다른가? | ??? |

각 단계마다 ML vs LLM 적합성이 다를 수 있어요.

---

## 2라운드: 4a 탐색 단계 — 누가 유리한가

### 🤖 ML 엔지니어

**ML 관점에서 탐색**:

```
입력: Daygainer 500개 + 대조군 2000개
     각각 50개 지표 (RVOL, Gap, ATR, RSI, 이평선 거리, ...)
     
방법:
  1. 단변량 분석: 각 지표별 Daygainer vs 대조군 분포 비교
  2. t-test / Mann-Whitney: 통계적 유의미한 차이 검정
  3. Feature Importance: XGBoost 학습 후 중요 피처 랭킹

출력: 
  "RVOL, Gap, 5일선 돌파 여부가 가장 차별적"
```

**장점**: 정량적, 수천 개 샘플 빠르게 처리, 재현 가능  
**단점**: "왜"에 대한 설명 없음, 피처 간 상호작용 해석 어려움

---

### 🏦 금융공학 리서처

**LLM 관점에서 탐색**:

```
입력: Daygainer 50개 샘플의 지표 로그 + 뉴스 요약
     대조군 50개 샘플의 동일 정보

프롬프트:
  "다음은 당일 급등한 종목들(Daygainer)과 
   급등하지 않은 유사 종목들(대조군)의 데이터입니다.
   
   두 그룹 사이에 어떤 차이가 있는지 분석하세요.
   특히 급등 전날(D-1) 시점에서 관찰 가능했던 
   차이점에 집중하세요."

출력:
  "Daygainer 그룹에서 관찰되는 공통 패턴:
   1. RVOL이 2 이상인 경우가 72% (대조군 31%)
   2. 갭 상승 후 전일 종가 위 유지 비율 높음
   3. 뉴스 헤드라인에 '실적', 'FDA' 등 촉매 언급"
```

**장점**: 비정형 데이터(뉴스) 통합 가능, 인간 친화적 해석  
**단점**: 샘플 수 제한, 통계적 엄밀성 부족, 환각 위험

---

### 📊 퀀트

**중요한 차이점** 하나 짚겠습니다.

| 측면 | ML | LLM |
|------|-----|-----|
| 처리 가능 샘플 수 | 수만 개 | 수십~수백 개 (컨텍스트 한계) |
| 지표 수 | 수백 개 가능 | 토큰 한계로 선별 필요 |
| 숫자 연산 정확도 | 완벽 | 불안정 (계산 오류 가능) |
| 비정형 데이터 | NLP 별도 파이프라인 필요 | 네이티브 처리 |

**탐색 단계에서 ML이 먼저 돌아야 합니다.**  
이유: 50개 지표 × 2500 샘플을 LLM 컨텍스트에 못 넣어요.

---

### 💹 단타 트레이더

동의해요. 그런데 ML이 놓치는 게 있어요.

예를 들어:
- "전날 종가에서 급락 후 꼬리 달고 마감" — 이건 OHLC 숫자로 추출 가능
- "장 마감 10분 전 대량 체결" — 이건 틱 데이터 필요
- "CEO가 트위터에 암시적 발언" — 이건 텍스트 필요

**ML은 피처화된 것만 봅니다.** 피처화 안 된 건 못 봐요.

그래서 탐색 단계에서도 **LLM이 정성적 가설 제안**하고,  
그걸 **ML이 정량적 검증**하는 루프가 필요하지 않을까요?

---

### 🔧 백엔드 개발자

그럼 탐색 단계 결론:

```
┌────────────────────────────────────────────────────────────┐
│  4a. 탐색 (EDA) 하이브리드                                  │
├────────────────────────────────────────────────────────────┤
│                                                            │
│  ┌─────────────┐     가설     ┌─────────────┐             │
│  │    LLM     │─────────────▶│     ML      │             │
│  │ 정성적 탐색 │             │ 정량적 검증  │             │
│  └─────────────┘◀────────────└─────────────┘             │
│                   결과 피드백                              │
│                                                            │
│  예시:                                                     │
│  LLM: "종가 대비 저점 위치가 중요해 보임"                   │
│  → ML: low_to_close_ratio 피처 생성 후 검증                │
│  → ML: "p < 0.01로 유의미" → LLM에 피드백                  │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

---

## 3라운드: 4b 모델링 단계 — 누가 유리한가

### 🤖 ML 엔지니어

**모델링은 ML 영역입니다.** 이건 논쟁 여지 없어요.

```python
# 표준 파이프라인
X = daygainer_features + control_features  # (2500, 50)
y = [1]*500 + [0]*2000  # Daygainer=1, Control=0

model = XGBClassifier()
model.fit(X_train, y_train)

# 평가
y_pred = model.predict_proba(X_test)[:, 1]
precision_at_k(y_test, y_pred, k=20)
```

**LLM은 분류기가 아닙니다.** 

LLM에게 "이 종목 급등할까요?"라고 물으면:
- 확률값 없음 (있어도 캘리브레이션 안 됨)
- 동일 입력에 다른 답
- 백테스트 불가능

---

### 🏦 금융공학 리서처

**동의합니다.** 모델링은 ML.

다만, **LLM이 피처 엔지니어링을 도울 수 있어요**:

```
프롬프트:
  "다음 종목의 원시 데이터가 있습니다.
   급등 예측에 유용할 수 있는 파생 지표를 제안하세요.
   
   예시 데이터:
   - OHLCV (5분봉, 일봉)
   - 거래량 프로파일
   - 호가창 스냅샷
   - 최근 뉴스 헤드라인"

LLM 출력:
  "제안 지표:
   1. 장 마감 30분 거래량 / 전일 동 시간대 거래량
   2. 5분봉 종가들의 고점 대비 위치 분포
   3. 뉴스 헤드라인 감성 점수 (긍정/부정/중립)"
```

이런 식으로 **도메인 지식을 피처로 변환**하는 데 LLM 활용.

---

### 📊 퀀트

핵심 정리:

| 4b 모델링 세부 | 담당 |
|----------------|------|
| 피처 아이디어 | LLM 보조 |
| 피처 구현 | 개발자 |
| 모델 학습/평가 | ML |
| 하이퍼파라미터 튜닝 | ML (Optuna 등) |

---

## 4라운드: 4c 해석 단계 — 누가 유리한가

### 💹 단타 트레이더

여기가 **LLM이 진짜 유용한 곳**이에요.

ML 모델이 "RVOL > 2.5, Gap > 3%면 급등 확률 0.7"이라고 해도  
**왜 그런지 설명 못 해요.**

SHAP 그래프 보여줘도 비전문가는 못 알아들어요.

LLM에게:
```
"이 종목은 ML 모델이 급등 확률 0.82로 예측했습니다.
 주요 기여 요인: RVOL 3.2, Gap +4.1%, 20MA 돌파
 
 왜 이 요인들이 급등과 관련되는지 
 데이 트레이딩 관점에서 설명해주세요."
```

LLM:
```
"RVOL 3.2는 평소 대비 3배 이상의 거래가 발생했다는 의미입니다.
 이는 기관이나 대형 투자자의 관심을 시사합니다.
 
 4.1% 갭 상승은 장외에서 이미 매수세가 유입되었음을 보여주며,
 20일 이평선 돌파는 중기 추세 전환 신호로 해석됩니다..."
```

---

### 🏦 금융공학 리서처

**투자 리포트 자동화**에도 쓸 수 있어요.

기관에서는 "왜 이 종목을 샀는가" 기록 의무가 있는데,  
LLM이 ML 결과를 해석해서 리포트 초안 생성 가능.

---

### 🤖 ML 엔지니어

해석 단계 정리:

| 해석 유형 | 도구 |
|-----------|------|
| 피처 중요도 랭킹 | ML (SHAP, Permutation) |
| 개별 예측 설명 | ML (SHAP Local) |
| 자연어 변환 | LLM |
| 도메인 컨텍스트 추가 | LLM |

**ML이 "무엇이" 중요한지 알려주고, LLM이 "왜" 중요한지 설명**합니다.

---

## 5라운드: 최종 합의

### 📊 퀀트

단계별 역할 분담 정리:

| 단계 | 주 담당 | 보조 |
|------|---------|------|
| **4a. 탐색** | ML (정량 분석) | LLM (가설 제안) |
| **4b. 모델링** | ML (전담) | LLM (피처 아이디어) |
| **4c. 해석** | LLM (자연어) | ML (수치 근거) |

---

### 🔧 백엔드 개발자

**구현 아키텍처**:

```
┌─────────────────────────────────────────────────────────────────────┐
│                     4. 특징 분석 파이프라인                          │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌───────────────────────────────────────────────────────────────┐ │
│  │ 4a. 탐색 (EDA)                                                │ │
│  │                                                               │ │
│  │   LLM ──(가설)──▶ ML ──(검증 결과)──▶ LLM ──(다음 가설)        │ │
│  │                     │                                         │ │
│  │                     ▼                                         │ │
│  │              유의미한 피처 목록                                │ │
│  └───────────────────────────────────────────────────────────────┘ │
│                          │                                         │
│                          ▼                                         │
│  ┌───────────────────────────────────────────────────────────────┐ │
│  │ 4b. 모델링 (ML 전담)                                          │ │
│  │                                                               │ │
│  │   피처 선택 → 모델 학습 → Cross-Validation → 최종 모델        │ │
│  │                                                               │ │
│  └───────────────────────────────────────────────────────────────┘ │
│                          │                                         │
│                          ▼                                         │
│  ┌───────────────────────────────────────────────────────────────┐ │
│  │ 4c. 해석                                                      │ │
│  │                                                               │ │
│  │   ML(SHAP) ──(수치)──▶ LLM ──(자연어 설명)──▶ 리포트          │ │
│  │                                                               │ │
│  └───────────────────────────────────────────────────────────────┘ │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

### 🏦 금융공학 리서처

**핵심 결론**:

> [!IMPORTANT]
> **"ML이냐 LLM이냐"는 잘못된 질문입니다.**
> 
> 올바른 답: **단계별로 다름**
> - 정량 분석/모델링 → ML
> - 가설 생성/해석 → LLM
> 
> 둘은 보완 관계이며, 파이프라인에서 각자 역할이 있습니다.

---

### 💹 단타 트레이더

실용적 조언:

> [!TIP]
> **초기 버전은 ML만으로 충분합니다.**
> 
> - LLM 없이도 SHAP로 해석 가능
> - LLM 통합은 파이프라인 복잡도 증가
> - v0.1: ML Only → v0.2: LLM 해석 추가

---

## 미해결 이슈

| 이슈 | 상태 |
|------|------|
| Daygainer 정의 (몇 % 상승?) | 🔲 TBD |
| 대조군 매칭 로직 상세 설계 | 🔲 TBD |
| LLM 가설-ML 검증 루프 자동화 가능성 | 🔲 연구 필요 |
| 비정형 데이터(뉴스) 피처화 방법 | 🔲 TBD |

---

**문서 이력**
| 버전 | 일자 | 변경 내용 |
|------|------|----------|
| 2.0 | 2026-01-15 | 파이프라인 기반 토론으로 재작성 |
