# Score V3 ê°œë°œ ê³„íšì„œ

**ë¬¸ì„œ ìœ í˜•**: ê°œë°œ ê³„íšì„œ  
**ì‘ì„±ì¼**: 2026-01-06  
**ì°¸ì¡°**: `docs/strategy/Score_v3.md`

---

## 1. ê°œìš”

Score V2ì˜ í•œê³„ì ì„ í•´ê²°í•˜ê¸° ìœ„í•œ Score V3 "Pinpoint" Algorithm ë„ì… ê³„íš.

### 1.1 V3 í•µì‹¬ ë³€ê²½ì‚¬í•­

| ì˜ì—­ | V2 (í˜„ì¬) | V3 (ê°œì„ ) |
|------|-----------|-----------|
| **Tight Range** | ì„ í˜• ë¹„ìœ¨ (ATRâ‚…/ATRâ‚‚â‚€) | **Z-Score + Sigmoid** (ìƒëŒ€í‰ê°€) |
| **Volume Dryout** | ë‹¨ìˆœ ë¹„ìœ¨ | **í•˜ë°© ê²½ì§ì„±(Support) ì²´í¬** |
| **VWAP** | ë¯¸ì‚¬ìš© | **VWAP ì´ê²©ë„** (ì„¸ë ¥ í‰ë‹¨ í™•ì¸) |
| **ì ìˆ˜ êµ¬ì¡°** | ë‹¨ìˆœ í•©ì‚° | **Base Ã— Boost Ã— Penalty** |
| **ë¦¬ìŠ¤í¬ ê´€ë¦¬** | ì—†ìŒ | **ëŒ€ëŸ‰ ìŒë´‰ í˜ë„í‹°** |

### 1.2 ê°€ì¤‘ì¹˜ ì¬ì¡°ì •

```
V2: TR(30%) + OBV(35%) + AB(25%) + VD(10%)
V3: TR(30%) + OBV(35%) + AB(20%) + VD(15%)
```

---

## 2. ì»´í“¨íŒ… íŒŒì›Œ ë¶€í•˜ ì˜ˆì¸¡

> **Note**: VWAPì€ Massive.com APIì—ì„œ ì§ì ‘ ìˆ˜ì‹ í•˜ë¯€ë¡œ ê³„ì‚° ë¹„ìš©ì´ ì—†ìŠµë‹ˆë‹¤.

### 2.1 ì—°ì‚°ëŸ‰ ì¦ê°€

| í•­ëª© | V2 | V3 | ì¦ê°€ìœ¨ |
|------|-----|-----|--------|
| **ì¼ë´‰ íˆìŠ¤í† ë¦¬** | 20ì¼ | 60ì¼ | 3Ã— |
| **1íšŒ ê³„ì‚° (ì¢…ëª©ë‹¹)** | ~5ms | ~15ms | 3Ã— |
| **50ì¢…ëª© ë°°ì¹˜** | ~250ms | **~750ms** | **3Ã—** |
| **VWAP** | - | API ìˆ˜ì‹  (0ms) | - |

### 2.2 ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰

| í•­ëª© | V2 | V3 |
|------|-----|-----|
| **ì¢…ëª©ë‹¹ ë©”ëª¨ë¦¬** | ~2KB | ~8KB |
| **50ì¢…ëª© ê¸°ì¤€** | ~100KB | ~400KB |

---

## 3. ê¶Œì¥ Refresh Rate

| ì‹œë‚˜ë¦¬ì˜¤ | ê³„ì‚° ì‹œê°„ | Interval | CPU ë¶€í•˜ |
|----------|----------|----------|----------|
| V2 (í˜„ì¬) | ~250ms | 1ë¶„ | ~0.4% |
| **V3** | ~750ms | **1ë¶„** | ~1.3% |
| V3 (ì—¬ìœ ) | ~750ms | 2ë¶„ | ~0.6% |

### ê¶Œì¥ ì„¤ì •

```
Refresh Interval: 60ì´ˆ (1ë¶„) - V2ì™€ ë™ì¼ ìœ ì§€ ê°€ëŠ¥
Z-Score Lookback: 60ì¼
VWAP: Massive APIì—ì„œ ì§ì ‘ ìˆ˜ì‹ 
```

> **ê·¼ê±°**: VWAP ê³„ì‚°ì´ ì œì™¸ë˜ì–´ V3ë„ 1ë¶„ Refresh ê°€ëŠ¥.  
> CPU ë¶€í•˜ 1.3%ë¡œ ì‹¤ì‚¬ìš©ì— ë¬¸ì œ ì—†ìŒ.

---

## 4. êµ¬í˜„ íŒŒì¼ ë³€ê²½ ëª©ë¡

### 4.1 ìˆ˜ì • íŒŒì¼

| íŒŒì¼ | ë³€ê²½ ë‚´ìš© |
|------|----------|
| `backend/strategies/seismograph.py` | V3 ê³„ì‚° ë©”ì„œë“œ ì¶”ê°€ |
| `backend/core/zscore_calculator.py` | ATR Z-Score í•¨ìˆ˜ ì¶”ê°€ |
| `docs/strategy/score_v2_formula.md` | V3 ì„¹ì…˜ ì¶”ê°€ |

### 4.2 ì‹ ê·œ íŒŒì¼

| íŒŒì¼ | ë‚´ìš© |
|------|------|
| `backend/strategies/score_v3_config.py` | V3 ì„¤ì • ìƒìˆ˜ |

---

## 5. Massive.com API VWAP ì§€ì› ì¡°ì‚¬

### 5.1 í˜„í™©

**ê²°ë¡ : Massive.comì€ VWAPì„ APIë¡œ ì œê³µí•©ë‹ˆë‹¤.**

| ì±„ë„ | VWAP í•„ë“œ | í˜„ì¬ êµ¬í˜„ ìƒíƒœ |
|------|----------|---------------|
| **AM (Aggregate Minute)** | `a` (VWAP) | âœ… ì´ë¯¸ ìˆ˜ì‹  ì¤‘ |
| REST Daily Bars | `vw` (VWAP) | ğŸ”² ë¯¸ì‚¬ìš© |

### 5.2 í˜„ì¬ êµ¬í˜„ (`massive_ws_client.py:315`)

```python
bar = {
    "type": "bar",
    "ticker": data.get("sym"),
    ...
    "vwap": data.get("a"),  # â† ì´ë¯¸ VWAP ìˆ˜ì‹  ì¤‘
    ...
}
```

### 5.3 ë„ì… ê°€ëŠ¥ì„± í‰ê°€

| ë°©ì‹ | ì¥ì  | ë‹¨ì  | ì¶”ì²œ |
|------|------|------|------|
| **WebSocket AM VWAP** | ì‹¤ì‹œê°„, ì´ë¯¸ êµ¬í˜„ë¨ | ë¶„ë´‰ ë‹¨ìœ„ VWAP (ë‹¹ì¼ë§Œ) | â­ ì¥ì¤‘ìš© |
| **REST Daily VWAP** | 5ì¼ ëˆ„ì  ê°€ëŠ¥ | ì¶”ê°€ API í˜¸ì¶œ í•„ìš” | â­â­ V3ìš© |
| **ìì²´ ê³„ì‚°** | API ì˜ì¡´ì„± ì—†ìŒ | ì—°ì‚° ë¹„ìš© | â–³ ë°±ì—…ìš© |

### 5.4 ê¶Œì¥ ì „ëµ

1. **ì¥ì¤‘ Ignitionìš©**: ê¸°ì¡´ AM VWAP í™œìš© (ì´ë¯¸ ìˆ˜ì‹  ì¤‘)
2. **Score V3ìš©**: REST APIë¡œ 5ì¼ Daily VWAP ì¡°íšŒ (ì¶”ê°€ êµ¬í˜„ í•„ìš”)
3. **Fallback**: ìì²´ Typical Price ê³„ì‚° (API ì‹¤íŒ¨ ì‹œ)

### 5.5 REST Daily Bars VWAP ì—”ë“œí¬ì¸íŠ¸

```
GET https://api.massive.com/v2/aggs/ticker/{ticker}/range/1/day/{from}/{to}
```

**ì‘ë‹µ í•„ë“œ**:
- `vw`: Volume Weighted Average Price (ë‹¹ì¼)
- `v`: Volume
- `o`, `h`, `l`, `c`: OHLC

---

## 6. ë‹¤ìŒ ë‹¨ê³„

1. [ ] ì‚¬ìš©ì ê²°ì • í™•ì¸ (VWAP ëª¨ë“œ, Refresh Rate)
2. [ ] `score_v3_config.py` ìƒì„±
3. [ ] `seismograph.py`ì— V3 ë©”ì„œë“œ ì¶”ê°€
4. [ ] REST Daily VWAP ì¡°íšŒ í•¨ìˆ˜ ì¶”ê°€ (ì„ íƒ)
5. [ ] í…ŒìŠ¤íŠ¸ ë° ê²€ì¦
